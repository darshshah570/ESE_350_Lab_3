#include <asf.h>
#include <stdio.h>
#include <avr/io.h>
#include <avr/interrupt.h>
#include "uart.h"
#include "util/delay.h"

volatile int overflows;

/*ISR(TIMER1_OVF_vect) {
    //TCCR1B ^= 0x40; // Toggle the input capture edge at the ICES1 bit in TCCR1B
    overflows++;
    if (overflows >= 1) {
        overflows = 0;
        PORTB ^= 0x02; // Toggle the on-off state of the piezo buzzer
    }
    putchar('c');
}*/

int main (void)
{
    uart_init();
    putchar('b');
    DDRB = 0x02;   // Allow PB1 (PIN 9) to be an output pin on the Arduino
    TCNT1 = 0;
    TCCR1B = 0x01; // Pre-scaling by 1024 gives clock frequency of 15.6kHz
    TIMSK1 = 0x01; // Enable timer overlow interrupt
    sei();         // Allow interrupts globally
    while(1) {
        if (TCNT1 >= 60) {
            putchar('c');
            PORTB ^= 0x02;
            TCNT1 = 0;
        }
    }   // Run program forever
}
    
